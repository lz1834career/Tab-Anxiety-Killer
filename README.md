# Tab Anxiety Killer（非 AI 版）

智能轻巧的浏览器标签页管理器 - 自动分类、焦虑评分、一键归档

## 功能特性

### ✅ 1. 自动分类 Tabs（基于 URL + Title 规则）

使用简单的规则分类，无需 AI：

- **购物类**：匹配域名（taobao, amazon, jd）+ 包含"cart""product"字样
- **社交/消息**：twitter / wechat / whatsapp / reddit
- **工作类**：GitHub、Jira、Confluence
- **学习**：docs、stackoverflow、mdn
- **视频娱乐**：youtube、bilibili
- **搜索类**：google 搜索页（q=参数）
- **文章阅读**：medium、知乎、blog

### ✅ 2. 一键归档（保存当前全部 tabs 作为 Session）

- 可以保存当前所有标签页为会话，方便后续恢复
- 支持自定义会话名称
- 查看所有已归档的会话列表
- 支持恢复会话（在新标签页中打开）
- 支持删除不需要的会话

### ✅ 3. Tabs 的"焦虑值"评分

非常实用的焦虑评分系统：

| 指标 | 算法 | 含义 |
|------|------|------|
| 已打开多久 | Date.now() - tab.lastAccessed | 时间越长越焦虑 |
| 是否重复域名 | count 相同 domain | 代表"太多用途不明的窗口" |
| 是否未聚焦超过 X 分钟 | tab.active=false 且 lastActiveTime | 可能是"不敢关但没用" |
| 是否是搜索结果页 | URL 包含 q= | 大概率能关 |
| 是否是文章阅读页 | scrollTop < 300px | 打开没看，也可能关 |

这些加权 = 一个"焦虑分数"，用来排序 tabs。

### ✅ 4. 一键处理建议（无需 AI）

自动给出处理建议：

- **明显可关闭**：搜索结果页、重复域名
- **可收藏归档**：长时间未访问的 docs、教程
- **建议暂存**：购物车、未完成文章
- **保持打开**：active tabs、音频正在播放 tab

### ✅ 5. 查看归档会话

- 点击顶部"查看归档"按钮（📚图标）
- 查看所有已保存的会话列表
- 显示会话名称、保存时间、标签页数量
- 预览前 5 个标签页
- 支持恢复会话和删除会话

### ✅ 6. 按分类关闭标签页

- 在"按分类"视图模式下
- 每个分类组都有"关闭分类"按钮
- 一键关闭该分类下的所有标签页
- 关闭前会显示确认对话框，防止误操作

## 安装方法

### 方法一：不使用图标（快速开始）

当前版本已移除图标引用，可以直接加载使用。

### 方法二：生成图标（推荐）

1. 在浏览器中打开 `create-icons.html` 文件
2. 点击"下载"按钮，保存三个尺寸的图标文件
3. 将下载的图标文件（icon16.png, icon48.png, icon128.png）放到 `icons/` 目录
4. 恢复 `manifest.json` 中的图标配置（取消注释图标相关代码）

### 加载扩展

1. 打开 Chrome 浏览器
2. 访问 `chrome://extensions/`
3. 开启"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择本项目文件夹

## 使用方法

### 基本操作

1. **打开扩展**：点击浏览器工具栏的扩展图标
2. **查看标签页**：
   - 切换到"按焦虑值"视图：按焦虑分数从高到低排序
   - 切换到"按分类"视图：按分类分组显示
3. **查看统计信息**：顶部显示总标签数、高焦虑标签数、域名数

### 标签页管理

1. **关闭单个标签页**：点击标签页右侧的"×"按钮
2. **按分类关闭**：
   - 切换到"按分类"视图
   - 找到要关闭的分类
   - 点击分类标题旁的"关闭分类"按钮
   - 确认后关闭该分类下的所有标签页
3. **使用智能建议**：
   - 查看顶部的处理建议区块
   - 点击"一键处理"按钮批量操作

### 归档功能

1. **保存当前会话**：
   - 点击顶部"归档"按钮（📦图标）
   - 输入会话名称（可选）
   - 会话已保存到本地存储

2. **查看归档会话**：
   - 点击顶部"查看归档"按钮（📚图标）
   - 浏览所有已保存的会话
   - 查看会话详情和标签页预览

3. **恢复会话**：
   - 在归档视图中找到要恢复的会话
   - 点击"恢复会话"按钮
   - 所有标签页会在新标签页中打开

4. **删除会话**：
   - 在归档视图中找到要删除的会话
   - 点击"删除"按钮
   - 确认后删除该会话

### 视图模式

- **按焦虑值**：按焦虑分数排序，高焦虑标签页优先显示
- **按分类**：按分类分组，方便批量管理同类标签页

## 文件结构

```
BrowserTabCleaning/
├── manifest.json          # 扩展配置文件
├── popup.html            # 弹窗界面
├── popup.js              # 弹窗主逻辑
├── tabClassifier.js      # 标签页分类器（规则引擎）
├── anxietyScorer.js      # 焦虑值评分器（评分算法）
├── tabManager.js         # 标签页管理器（核心功能）
├── background.js         # 后台服务脚本
├── styles.css            # 样式文件
├── icons/                # 图标目录
│   └── README.md         # 图标说明
└── README.md            # 说明文档
```

## 技术实现

### 核心模块

- **tabClassifier.js**：标签页分类器
  - 基于域名匹配和关键词匹配的规则引擎
  - 支持 8 种分类：购物、社交、工作、学习、视频、搜索、阅读、其他
  - 可扩展的分类规则系统

- **anxietyScorer.js**：焦虑值评分器
  - 多维度加权评分系统（0-100分）
  - 5 个评分维度：打开时长、重复域名、未聚焦时长、搜索结果页、未读文章
  - 可配置的权重和阈值

- **tabManager.js**：标签页管理器
  - 标签页信息聚合和分类
  - 会话保存和恢复
  - 智能处理建议生成
  - 批量操作支持

### 技术栈

- **Chrome Extension API**：tabs, storage, activeTab
- **存储**：Chrome Storage API（local storage）
- **UI**：原生 HTML/CSS/JavaScript，现代化响应式设计
- **图标**：SVG 矢量图标，支持高分辨率显示

## 注意事项

- **浏览器要求**：需要 Chrome 浏览器（支持 Manifest V3）
- **权限要求**：需要授予标签页和存储权限（已在 manifest.json 中声明）
- **图标文件**：扩展图标需要自行添加（或使用默认图标占位符）
- **数据存储**：会话数据存储在浏览器本地，不会上传到服务器
- **隐私保护**：所有数据处理都在本地完成，不会收集任何用户信息

## 使用技巧

1. **定期清理**：建议每天使用一次，保持标签页数量在合理范围
2. **分类管理**：使用"按分类"视图可以快速找到同类标签页
3. **归档重要会话**：在关闭标签页前，先归档保存重要的工作会话
4. **关注焦虑值**：高焦虑值的标签页通常是长时间未使用或重复的，可以优先关闭
5. **利用智能建议**：根据系统建议批量处理标签页，提高效率

## 常见问题

**Q: 归档的会话会占用多少存储空间？**  
A: 每个会话只保存 URL、标题和图标 URL，占用空间很小，通常每个会话只有几 KB。

**Q: 可以导出归档的会话吗？**  
A: 当前版本暂不支持导出功能，会话数据存储在浏览器本地。

**Q: 焦虑值是如何计算的？**  
A: 焦虑值基于 5 个维度加权计算：打开时长（30%）、重复域名（25%）、未聚焦时长（20%）、搜索结果页（15%）、未读文章（10%）。

**Q: 可以自定义分类规则吗？**  
A: 当前版本不支持自定义分类规则，但可以在 `tabClassifier.js` 中手动添加规则。

## 未来改进

- [x] 支持会话恢复功能
- [x] 按分类关闭标签页
- [x] 查看归档会话列表
- [x] SVG 图标优化
- [ ] 支持自定义分类规则
- [ ] 支持自定义焦虑评分权重
- [ ] 添加统计图表和数据可视化
- [ ] 支持导出/导入会话数据
- [ ] 添加键盘快捷键支持
- [ ] 支持标签页搜索功能
- [ ] 添加暗色主题支持

